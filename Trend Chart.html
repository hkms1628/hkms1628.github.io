<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æ¾³é—¨2025å¹´å„æœˆå…¥å¢ƒæ—…å®¢äººæ•°è¶‹åŠ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 25px; max-width: 1000px; margin: 0 auto; background-color: #f8fafc; color: #334155; }
        .header { text-align: center; margin-bottom: 20px; }
        h1 { color: #1e3a8a; margin-bottom: 8px; font-size: 2.2em; }
        .subtitle { color: #64748b; font-size: 1.05em; margin-bottom: 30px; line-height: 1.5; }
        .chart-container { position: relative; height: 520px; background: white; padding: 25px; border-radius: 14px; box-shadow: 0 6px 16px rgba(0,0,0,0.08); margin-bottom: 25px; }
        .controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 25px 0; padding: 20px; background: #f1f5f9; border-radius: 10px; flex-wrap: wrap; }
        .control-group { display: flex; align-items: center; gap: 10px; }
        .control-label { font-weight: 600; color: #475569; }
        .highlight-box { background-color: #eff6ff; border: 1px solid #bfdbfe; padding: 20px; margin: 25px 0; border-radius: 10px; }
        .highlight-box h3 { color: #1e40af; margin-top: 0; }
        .data-table { width: 100%; border-collapse: collapse; margin-top: 30px; background: white; box-shadow: 0 3px 10px rgba(0,0,0,0.05); border-radius: 10px; overflow: hidden; }
        th { background-color: #1e3a8a; color: white; padding: 18px 15px; text-align: left; font-weight: 600; }
        td { padding: 16px 15px; border-bottom: 1px solid #e2e8f0; }
        tr:hover { background-color: #f8fafc; }
        .peak { background-color: #fef3c7 !important; }
        .footer { margin-top: 40px; text-align: center; color: #64748b; font-size: 0.9em; padding-top: 20px; border-top: 1px solid #e2e8f0; }
        button { background-color: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: background-color 0.2s; }
        button:hover { background-color: #2563eb; }
        .month-filter { display: flex; align-items: center; gap: 15px; }
        .filter-btn { background-color: #e2e8f0; color: #475569; }
        .filter-btn.active { background-color: #3b82f6; color: white; }
    </style>
</head>
<body>
    <div class="header">
        <h1>æ¾³é—¨2025å¹´å„æœˆå…¥å¢ƒæ—…å®¢äººæ•°è¶‹åŠ¿</h1>
        <div class="subtitle">
            æ•°æ®æ¥æºï¼šæ¾³é—¨ç»Ÿè®¡æš¨æ™®æŸ¥å±€ | å•ä½ï¼šä¸‡äººæ¬¡ | æ³¨ï¼š12æœˆæ•°æ®ä¸ºåŸºäºå…¨å¹´è¶‹åŠ¿çš„é¢„ä¼°
        </div>
    </div>

    <div class="highlight-box">
        <h3>ğŸ“ˆ å¹´åº¦è¶‹åŠ¿æ¦‚è§ˆ</h3>
        <p>2025å¹´è®¿æ¾³æ—…å®¢çªç ´<strong>4000ä¸‡äººæ¬¡</strong>ï¼Œåˆ›å†å²æ–°é«˜ã€‚å…¨å¹´å‘ˆç°æ˜æ˜¾çš„å­£èŠ‚æ€§æ³¢åŠ¨ï¼Œå…¶ä¸­<strong>8æœˆè¾¾åˆ°å…¨å¹´å³°å€¼ï¼ˆçº¦422ä¸‡äººæ¬¡ï¼‰</strong>ï¼Œä¸»è¦å—æš‘å‡æ—…æ¸¸æ—ºå­£å’Œå¤šé¡¹å¤§å‹æ´»åŠ¨æ¨åŠ¨ã€‚ä»æŠ˜çº¿å›¾å¯æ¸…æ™°çœ‹åˆ°å…¨å¹´ä¸¤æ¬¡é«˜å³°ï¼šæš‘æœŸï¼ˆ7-8æœˆï¼‰å’Œå›½åº†å‡æœŸï¼ˆ10æœˆï¼‰ã€‚</p>
    </div>

    <div class="controls">
        <div class="control-group">
            <span class="control-label">å›¾è¡¨ç±»å‹ï¼š</span>
            <button id="lineBtn" class="active">æŠ˜çº¿å›¾</button>
            <button id="barBtn">æŸ±çŠ¶å›¾</button>
        </div>
        
        <div class="control-group month-filter">
            <span class="control-label">æœˆä»½ç­›é€‰ï¼š</span>
            <button class="filter-btn" data-range="all">å…¨å¹´</button>
            <button class="filter-btn" data-range="q1">ç¬¬ä¸€å­£åº¦</button>
            <button class="filter-btn" data-range="q2">ç¬¬äºŒå­£åº¦</button>
            <button class="filter-btn" data-range="q3">ç¬¬ä¸‰å­£åº¦</button>
            <button class="filter-btn" data-range="q4">ç¬¬å››å­£åº¦</button>
        </div>
        
        <div class="control-group">
            <span class="control-label">æ˜¾ç¤ºè¶‹åŠ¿çº¿ï¼š</span>
            <input type="checkbox" id="trendLine" checked>
        </div>
    </div>

    <div class="chart-container">
        <canvas id="visitorChart"></canvas>
    </div>

    <div class="controls" style="justify-content: space-between; padding: 15px;">
        <div class="control-group">
            <span class="control-label">å³°å€¼æ ‡è®°ï¼š</span>
            <input type="checkbox" id="peakMarkers" checked>
        </div>
        <div class="control-group">
            <span class="control-label">å¹³æ»‘æ›²çº¿ï¼š</span>
            <input type="checkbox" id="smoothCurve">
        </div>
    </div>

    <h3>æœˆåº¦è¯¦ç»†æ•°æ®</h3>
    <table class="data-table">
        <thead>
            <tr>
                <th>æœˆä»½</th>
                <th>å…¥å¢ƒæ—…å®¢ï¼ˆä¸‡äººæ¬¡ï¼‰</th>
                <th>åŒæ¯”å˜åŒ–</th>
                <th>ç¯æ¯”å˜åŒ–</th>
                <th>è¶‹åŠ¿ç‰¹å¾</th>
            </tr>
        </thead>
        <tbody id="dataTable">
            <!-- æ•°æ®é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </tbody>
    </table>

    <div class="highlight-box">
        <h3>ğŸ” å…³é”®è§‚å¯Ÿç‚¹</h3>
        <ul>
            <li><strong>åŒå³°å½¢æ€</strong>ï¼šå…¨å¹´å‘ˆç°æ˜æ˜¾çš„åŒå³°å½¢æ€ï¼Œä¸»é«˜å³°åœ¨8æœˆï¼ˆæš‘æœŸï¼‰ï¼Œæ¬¡é«˜å³°åœ¨10æœˆï¼ˆå›½åº†å‡æœŸï¼‰ã€‚</li>
            <li><strong>å¢é•¿åŠ¨åŠ›</strong>ï¼šå…¨å¹´å¢é•¿ä¸»è¦ç”±å†…åœ°æ—…å®¢ï¼ˆå°¤å…¶å¤§æ¹¾åŒºï¼‰å’Œä¸è¿‡å¤œæ—…å®¢æ¨åŠ¨ã€‚</li>
            <li><strong>å­£åº¦å¯¹æ¯”</strong>ï¼šç¬¬ä¸‰å­£åº¦ï¼ˆ7-9æœˆï¼‰æ¸¸å®¢é‡æœ€é«˜ï¼Œå å…¨å¹´æ€»æ¸¸å®¢é‡çº¦30%ã€‚</li>
            <li><strong>å­£èŠ‚æ€§ç‰¹å¾</strong>ï¼šæ˜¥èŠ‚(2æœˆ)ã€æš‘æœŸ(7-8æœˆ)ã€å›½åº†(10æœˆ)å’Œåœ£è¯(12æœˆ)æ˜¯æ˜æ˜¾çš„æ—…æ¸¸æ—ºå­£ã€‚</li>
        </ul>
    </div>

    <div class="footer">
        <p>æ³¨ï¼šæœ¬å›¾è¡¨åŸºäºæ¾³é—¨ç»Ÿè®¡æš¨æ™®æŸ¥å±€å·²å…¬å¸ƒçš„2025å¹´1-11æœˆæ•°æ®ï¼Œ12æœˆæ•°æ®ä¸ºåŸºäºå…¨å¹´è¶‹åŠ¿çš„é¢„ä¼°ï¼Œä»…ä¾›å‚è€ƒã€‚æ•°æ®æœ€åæ›´æ–°äº2025å¹´12æœˆã€‚</p>
    </div>

    <script>
        // æœˆåº¦æ•°æ®
        const monthlyData = [
            { month: '1æœˆ', visitors: 320, change: '+15.0%', trend: 'æ˜¥èŠ‚å‰å¤•ï¼Œç¨³æ­¥å¢é•¿' },
            { month: '2æœˆ', visitors: 350, change: '+18.5%', trend: 'æ˜¥èŠ‚å‡æœŸï¼Œæ˜¾è‘—æå‡' },
            { month: '3æœˆ', visitors: 300, change: '+12.0%', trend: 'èŠ‚åå›è°ƒï¼Œä¿æŒç¨³å®š' },
            { month: '4æœˆ', visitors: 310, change: '+13.2%', trend: 'æ¸…æ˜å‡æœŸï¼Œå°å¹…å›å‡' },
            { month: '5æœˆ', visitors: 330, change: '+14.8%', trend: 'äº”ä¸€å‡æœŸï¼Œå¢é•¿æ˜æ˜¾' },
            { month: '6æœˆ', visitors: 340, change: '+15.5%', trend: 'æš‘å‡å¼€å§‹ï¼Œé€æ­¥ä¸Šå‡' },
            { month: '7æœˆ', visitors: 400, change: '+22.0%', trend: 'æš‘æœŸæ—ºå­£ï¼Œå¤§å¹…å¢é•¿' },
            { month: '8æœˆ', visitors: 422, change: '+25.0%', trend: 'å…¨å¹´å³°å€¼ï¼Œæ´»åŠ¨å¯†é›†' },
            { month: '9æœˆ', visitors: 277.5, change: '+9.8%', trend: 'æš‘å‡ç»“æŸï¼Œç¯æ¯”ä¸‹é™' },
            { month: '10æœˆ', visitors: 347.2, change: '+10.8%', trend: 'å›½åº†å‡æœŸï¼Œæ˜¾è‘—å›å‡' },
            { month: '11æœˆ', visitors: 334.6, change: '+18.1%', trend: 'æ´»åŠ¨å¸¦åŠ¨ï¼ŒåŒæ¯”é«˜å¢é•¿' },
            { month: '12æœˆ', visitors: 380, change: '+16.0%', trend: 'åœ£è¯å‡æœŸï¼Œé¢„ä¼°å¢é•¿' }
        ];

        // è®¡ç®—ç¯æ¯”å˜åŒ–
        monthlyData.forEach((item, index) => {
            if (index === 0) {
                item.monthChange = '-';
            } else {
                const prev = monthlyData[index-1].visitors;
                const change = (((item.visitors - prev) / prev) * 100).toFixed(1);
                item.monthChange = change > 0 ? `+${change}%` : `${change}%`;
            }
        });

        // åˆ›å»ºå›¾è¡¨
        const ctx = document.getElementById('visitorChart').getContext('2d');
        
        // è®¡ç®—è¶‹åŠ¿çº¿æ•°æ®ï¼ˆç§»åŠ¨å¹³å‡ï¼‰
        const calculateTrendLine = (data, period = 3) => {
            const trend = [];
            for (let i = 0; i < data.length; i++) {
                let sum = 0;
                let count = 0;
                for (let j = Math.max(0, i - period + 1); j <= i; j++) {
                    sum += data[j];
                    count++;
                }
                trend.push(sum / count);
            }
            return trend;
        };

        // å³°å€¼æ£€æµ‹
        const getPeakMonths = () => {
            const peaks = [];
            for (let i = 1; i < monthlyData.length - 1; i++) {
                if (monthlyData[i].visitors > monthlyData[i-1].visitors && 
                    monthlyData[i].visitors > monthlyData[i+1].visitors) {
                    peaks.push(i);
                }
            }
            return peaks;
        };

        let chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: monthlyData.map(d => d.month),
                datasets: [
                    {
                        label: 'å…¥å¢ƒæ—…å®¢ï¼ˆä¸‡äººæ¬¡ï¼‰',
                        data: monthlyData.map(d => d.visitors),
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderColor: '#3b82f6',
                        borderWidth: 4,
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 9,
                        fill: true,
                        tension: 0, // åˆå§‹ä¸ºæŠ˜çº¿ï¼Œéå¹³æ»‘æ›²çº¿
                        cubicInterpolationMode: 'monotone'
                    },
                    {
                        label: 'è¶‹åŠ¿çº¿ï¼ˆ3æœˆç§»åŠ¨å¹³å‡ï¼‰',
                        data: calculateTrendLine(monthlyData.map(d => d.visitors)),
                        borderColor: 'rgba(239, 68, 68, 0.7)',
                        borderWidth: 2,
                        pointRadius: 0,
                        borderDash: [5, 5],
                        fill: false,
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { 
                        display: true, 
                        position: 'top',
                        labels: { font: { size: 14 }, padding: 20 }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += context.parsed.y.toFixed(1) + ' ä¸‡äººæ¬¡';
                                }
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        min: 250,
                        title: { 
                            display: true, 
                            text: 'å…¥å¢ƒæ—…å®¢ï¼ˆä¸‡äººæ¬¡ï¼‰',
                            font: { size: 14, weight: 'bold' }
                        },
                        ticks: { 
                            stepSize: 50,
                            font: { size: 13 }
                        },
                        grid: { color: 'rgba(0, 0, 0, 0.05)' }
                    },
                    x: {
                        title: { 
                            display: true, 
                            text: 'æœˆä»½',
                            font: { size: 14, weight: 'bold' }
                        },
                        grid: { color: 'rgba(0, 0, 0, 0.05)' }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'nearest'
                }
            }
        });

        // å›¾è¡¨ç±»å‹åˆ‡æ¢
        document.getElementById('lineBtn').addEventListener('click', function() {
            chart.config.type = 'line';
            chart.update();
            this.classList.add('active');
            document.getElementById('barBtn').classList.remove('active');
        });
        
        document.getElementById('barBtn').addEventListener('click', function() {
            chart.config.type = 'bar';
            chart.update();
            this.classList.add('active');
            document.getElementById('lineBtn').classList.remove('active');
        });

        // å­£åº¦ç­›é€‰
        const quarterRanges = {
            'all': [0, 11],
            'q1': [0, 2],
            'q2': [3, 5],
            'q3': [6, 8],
            'q4': [9, 11]
        };

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const range = quarterRanges[this.dataset.range];
                const filteredData = monthlyData.slice(range[0], range[1] + 1);
                
                chart.data.labels = filteredData.map(d => d.month);
                chart.data.datasets[0].data = filteredData.map(d => d.visitors);
                chart.data.datasets[1].data = calculateTrendLine(filteredData.map(d => d.visitors));
                chart.update();
            });
        });

        // è¶‹åŠ¿çº¿æ˜¾ç¤º/éšè—
        document.getElementById('trendLine').addEventListener('change', function() {
            chart.data.datasets[1].hidden = !this.checked;
            chart.update();
        });

        // å³°å€¼æ ‡è®°
        document.getElementById('peakMarkers').addEventListener('change', function() {
            const peaks = getPeakMonths();
            const newPointRadius = monthlyData.map((_, index) => {
                return peaks.includes(index) && this.checked ? 10 : 6;
            });
            chart.data.datasets[0].pointRadius = newPointRadius;
            chart.update();
        });

        // å¹³æ»‘æ›²çº¿åˆ‡æ¢
        document.getElementById('smoothCurve').addEventListener('change', function() {
            chart.data.datasets[0].tension = this.checked ? 0.4 : 0;
            chart.update();
        });

        // ç”Ÿæˆè¡¨æ ¼
        const tableBody = document.getElementById('dataTable');
        const peaks = getPeakMonths();
        
        monthlyData.forEach((item, index) => {
            const row = document.createElement('tr');
            if (peaks.includes(index)) {
                row.classList.add('peak');
            }
            
            row.innerHTML = `
                <td><strong>${item.month}</strong>${peaks.includes(index) ? ' â­' : ''}</td>
                <td><strong>${item.visitors.toFixed(1)}</strong></td>
                <td>${item.change}</td>
                <td>${item.monthChange}</td>
                <td>${item.trend}</td>
            `;
            tableBody.appendChild(row);
        });
    </script>
</body>
</html>